@model IEnumerable<BLLViews.Models.GetAllUsers>
@{
    ViewBag.Title = "_Users";

}
<table class="table  striped  table-border cell-border" id="Test1" data-role="table" data-show-activity="false" data-rownum="true">
    <thead>
        <tr>
            <th>FullName</th>
            <th>Username</th>
            <th>isBanned</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody class="fg-white" id="Users">
        @foreach (var el in Model)
        {

            <tr class="bd-darkRed">
                <td>@el.user.FullName</td>
                <td>@el.user.UserName</td>
                @if (el.isBanned)
                {
                    <td>
                        <button data-popover-trigger="click" class="button alert outline cell-12" data-popover-position="right" data-role="popover" data-popover-text='User banned!<br>Reason: @el.ban.Reason<br>To Date: @el.ban.ToDate<br>IsPermanent: @el.ban.IsPermanent<br>Ban Date: @el.ban.DateBan<br>  @Ajax.ActionLink("UNBAN", "UnBan", new { Id = el.user.Id }, new AjaxOptions { OnSuccess = "UnBanShow",OnBegin="LoaderJS", OnComplete="HideLoaderJS", OnFailure="ErrorJS" }, new { @class = "button alert outline" })'>Banned</button>
                    </td>
                }
                else
                {
                    <td>
                        <button data-popover-trigger="click" class="button alert outline cell-12" data-popover-position="right" data-role="popover" data-popover-text='User no banned!<br><button id = "OpenBan" onclick="ShowPartailBan()" class="button alert outline" data-value="@el.user.Id">BAN</button>'>Null</button>
                    </td>
                }

                <td>
                    <button class="button alert outline cell-12" type="button" onclick='getRoles("@el.user.Id")'>Roles</button>
                    @* @Ajax.ActionLink("Roles", "GetRoles", new { id = el.Id }, new AjaxOptions { OnBegin = "LoaderJS", OnComplete = "HideLoaderJS", OnFailure = "ErrorJS", OnSuccess = "ShowPartailRoles", UpdateTargetId = "TableUsers", InsertionMode = InsertionMode.Replace })*@
                </td>
           
            </tr>
        }


    </tbody>
</table>


<script>
    function getRoles(uid) {
    $.ajax({
        type: 'GET',
        url: '@Url.Action("GetRoles")/'+uid,
        dataType: 'html',
        data: 'source=' + uid,
        success: function (result) {
            $('#RolesPartial').html(result);
             setTimeout(function () {
            //let info = $("#OpenRoles").data("value");
            Metro.dialog.open('#demoDialog2');
            // $("#UidInRP").val(info);
        }, 10);
        },
        complete: function () {
            HideLoaderJS();
        },
        beforeSend: function () {
            LoaderJS();
        }
    });
};
 </script>
